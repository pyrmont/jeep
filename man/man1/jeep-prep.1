.\"
.\" Generated by predoc at 2025-09-12T14:50:26Z
.\"
.Dd September 9, 2025
.Dt JEEP-PREP 1
.Os Jeep 0.1.0-dev
.
.Sh NAME
.Ic \&jeep-prep
.Nd prepare a Janet project
.
.Sh SYNOPSIS
.Ic \&jeep-prep
.Oo
.Fl f No | 
.Fl -force-deps
.Oc
.Oo
.Fl D No | 
.Fl -no-deps
.Oc
.Oo
.Ar \&profile
.Oc
.
.Sh DESCRIPTION
.Ic \&jeep-prep
prepares a Janet project.
A project is prepared by installing dependencies and running the prep \c
.Sy bundle hook .
.
.Ss Options
.Pp
.Bl -tag -width Ds
.It Xo 
.Fl f, 
.Fl -force-deps
.Xc
This forces the installation of dependencies.
By default,
Janet will not install a dependency if it is already installed.
.It Xo 
.Fl D, 
.Fl -no-deps
.Xc
This skips the installation of dependencies.
In other words,
it only runs the prep \c
.Sy bundle hook .
.It Xo 
.Ar \&profile
.Xc
Specifies one of the following profiles to use:
.Pp
.Bl -tag -width Ds
.It Xo 
.Cm \&system
.Xc
By default,
.Ic \&jeep-prep
will use the 
.Cm \&system
profile.
This installs the dependencies listed under 
.Ql ":dependencies"
key in the \c
.Sy info file .
The dependencies are installed to the \c
.Sy sysroot .
.It Xo 
.Cm \&build
.Xc
If the user specifies the 
.Cm \&build
profile,
this copies into the 
.Eo
.Pa ./bundle
.Ec
directory several files from the Spork library that are commonly used at build-time:
.Pp
.Bl -bullet -offset 3n -compact
.It
build-rules.janet
.It
cc.janet
.It
cjanet.janet
.It
declare-cc.janet
.It
path.janet
.It
pm-config.janet
.It
sh.janet
.It
stream.janet
.El
.It Xo 
.Cm \&vendor
.Xc
If the user specifies the 
.Cm \&vendor
profile,
this vendors the dependencies listed under the 
.Ql ":vendored"
key in the \c
.Sy info file .
.El
.El
.Pp
For more information about the \c
.Sy info file ,
the \c
.Sy bundle script ,\c
.Sy bundle hooks
and the \c
.Sy sysroot ,
see CONCEPTS in 
.Xr jeep 1\& .
For more information about vendoring,
see Vendoring in 
.Xr jeep-dep 1\& .
.
.Sh OPERATION
.Ic \&jeep-prep
consists of a two-step workflow.
First,
dependencies are installed.
Second,
the prep \c
.Sy bundle hook
is run.
.Pp
The project author specifies each dependency using a struct.
The struct should,
at a minimum,
include the 
.Ql ":name"
and 
.Ql ":url"
keys.
If the struct includes a 
.Ql ":files"
key,
the dependency is not installed using the Janet’s 
.Ql "bundle/install"
function.
Instead 
.Ic \&jeep-prep
downloads the dependency and then copies the files listed.
If the 
.Ql ":prefix"
key exists,
the files are copied to a directory with a name that matches the associated value.
Dependencies can be added to the \c
.Sy info file
using 
.Xr jeep-dep 1\& .
.Pp
The project author optionally binds a function to the prep \c
.Sy bundle hook
by defining a function called 
.Ql "prep"
in the \c
.Sy bundle script .
When invoked,
the function will receive two arguments:
(1)
a table representing the bundle manifest and (2)
a string matching the name of the profile specified by the user.
.
.Sh EXAMPLES
The following examples assume an \c
.Sy info file
as follows:
.Bd -literal -offset indent
{:name \(dqexample\(dq
 :url \(dqhttps://example\&.org/example\(dq
 :repo \(dqgit+https://example\&.org/example\(dq

 :dependencies \(lB
   {:name \(dqdep1\(dq :url \(dqhttps://example\&.org/dep1\(dq}
   {:name \(dqdep2\(dq :url \(dqhttps://example\&.org/dep2\(dq}]

 :vendored {
   \(dqbundle\(dq \(lB
     {:name \(dqdep3\(dq :url \(dqhttps://example\&.org/dep3\(dq}]
   \(dqdeps\(dq \(lB
     {:name \(dqdep4\(dq :url \(dqhttps://example\&.org/dep4\(dq}
     {:name \(dqdep5\(dq
      :url \(dqhttps://example\&.org/dep5\(dq
      :prefix \(dqdep5\(dq
      :files \(lB\(dqfoo\&.janet\(dq \(dqLICENSE\(dq]}]}}
.Ed
.Pp
The following command prepares the project using the default 
.Cm \&system
profile.
This installs ‘dep1’ and ‘dep2’ to the global sysroot.
.Bd -literal -offset indent
$ jeep prep
.Ed
.Pp
The following command prepares the project using the 
.Cm \&system
profile.
This installs ‘dep1’ and ‘dep2’ to 
.Eo
.Pa ./_system
.Ec ,
the local sysroot.
.Bd -literal -offset indent
$ jeep -l prep system
.Ed
.Pp
The following command prepares the project using the 
.Cm \&vendor
profile.
This installs ‘dep3’ to the 
.Eo
.Pa ./bundle
.Ec
directory,
installs ‘dep4’ to the 
.Eo
.Pa ./deps
.Ec
directory and copies ‘foo.janet’ and ‘LICENSE’ to the 
.Eo
.Pa ./deps/dep5
.Ec
directory.
.Bd -literal -offset indent
$ jeep prep vendor
.Ed
.Pp
The following command prepares the project using the 
.Cm \&build
profile.
This copies the default build-time files to 
.Eo
.Pa ./bundle
.Ec .
.Bd -literal -offset indent
$ jeep prep build
.Ed
.
.Sh AUTHORS
.An Michael Camilleri Aq Mt mike@inqk.net
.
.Sh BUGS
Report issues at 
.Lk https://github.com/pyrmont/jeep
